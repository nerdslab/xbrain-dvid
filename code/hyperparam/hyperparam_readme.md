# Hyperparameter Search Readme

We have run the xbrain-celldetect classifier across a wide range of operating points.  For the initial runs, we grid searched across the following parameters.  Results can be found here:  https://drive.google.com/file/d/0B6iZJMt9RjNiYzlCMWplOVd3YkE/view?usp=sharing

## Protocol

A list of experiments are generated by sweeping over each choice of input.  We first form a comma separated list and then parcellate that list into LONI-compatible list files.
After running in LONI, we download (manually) the results and convert them to a structure suitable for downstream analysis.

## Parameters

- pthresh = [0.5:0.1:1];
- ballsz_init = [18, 20, 22, 24];
- ballsz_small = [12, 14, 16, 18];
- ballsz_large = [24, 26, 28, 30];
- presid = [0.5];
- bgfg_mode = [0, 1]; %gmm = 0; ilastik = 1

## Code 

The code used to run these experiments is in ./packages/celldetect/hyperp

## Results

For the moment, these can be found in google drive at the following location:
https://drive.google.com/folderview?id=0B6iZJMt9RjNiNFN0SVlYS01Ea0k&usp=sharing

Result sets that are not shown failed to run to completion because those parameter sets produced no centroids (typically occurs at high thresholds and/or large cell sizes).
GMM and Ilastik Code were computed on separate machines to increase throughput (and incidentally demonstrated pipeline flexibility).


## Next Steps

Additional parameters can be explored by sending Will a csv file with the following properties.  This allows for either a grid search or a targeted search.
[pthresh(i), ballsz_init(j), ballsz_small(k), ballsz_large(m), presid(n), bgfg_mode(o)]

We should carefully cross-check these results to be sure that error metrics are functioning as intended.  Two quick questions:
- no sep distance (it was removed, correct)?
- should we crop the borders before computing centroids?  Do we lose anything in metrics by removing the borders?
- It takes about 1 day to evaluate 300 operating points.  Each operating point costs about $0.10.
